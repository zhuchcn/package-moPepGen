{% set command = 'callVariant' %}
# {{ command }}

::: moPepGen.cli.call_variant_peptide
	handler: python
    selection:
      members: false
    rendering:
      show_root_heading: false
      show_source: false

{% include 'partials/_args_reference.md' %}

{% include 'partials/_args_codon_table.md' %}

## Peptide Finding Modes

The `callVariant` command supports three modes for discovering variant peptides, controlled by the `--peptide-finding-mode` option:

### `misc` Mode (Default)
The default mode for enzyme-based digestion. Uses enzymatic cleavage rules (e.g., trypsin) with configurable miscleavage allowance. Suitable for standard bottom-up proteomics workflows where peptides are generated by enzymatic digestion.

**Key parameters:**
- `--cleavage-rule`: Specify enzyme (e.g., `trypsin/P`)
- `--miscleavage`: Number of allowed missed cleavages
- `--min-length`, `--max-length`: Peptide length constraints

### `sliding-window` Mode
A comprehensive mode that generates all possible 8-11mer peptides containing at least one variant using a true sliding window approach. Optimized to avoid combinatorial explosion in hypermutated regions by using an atomic graph architecture where all nodes represent single amino acids. The output peptides can be used as candidate neoantigens. Each peptide is guaranteed to contain at least one variant and falls within the typical MHC-I binding length range.

**Key parameters:**
- `--cleavage-rule None`: Disable enzymatic cleavage
- `--min-length`: Minimum peptide length (default: 8)
- `--max-length`: Maximum peptide length (default: 11)
- `--peptide-finding-mode sliding-window`: Enable this mode

**Advantages:**
- No combinatorial explosion in hypermutated regions
- Complete coverage of all variant-containing peptides in the specified length range
- Efficient graph traversal using atomic (single amino acid) nodes

### `archipel` Mode
Designed for non-enzymatic applications where variants are treated as "islands" separated by reference sequences. This mode generates peptides centered around variant regions with flanking reference sequences. Best suited for scenarios with moderate variant density.

Each output peptide is structured such that:
- Flanking regions (without variants) on either side of a variant contain exactly `flanking_size` amino acids
- Between any two consecutive variants, there are no more than `flanking_size` continuous amino acids
- The resulting peptides contain all subsequences of 8-11mers as candidates for neoantigens
- The output FASTA is non-redundant and suitable for peptidomic database searches

**Key parameters:**
- `--cleavage-rule None`: Disable enzymatic cleavage
- `--flanking-size`: Number of reference amino acids (without variants) to include on either side of variant islands (default: 9)

**Note:** In hypermutated regions with many closely-spaced variants, this mode may experience combinatorial explosion as it enumerates all variant combinations. The `--min-length` and `--max-length` parameters are not used in this mode.

## Usage

```
{{ get_arg_usage(command) }}
```

## Arguments

{% with actions=get_arg_data(command) %}
{% include 'partials/_command_usage.md' %}
{% endwith %}